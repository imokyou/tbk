<?php /* ç¨‹åºä¾ CMSæ·˜å®å®¢ç³»ç»Ÿ ç¨‹åºä¾ ç‰ˆæƒæ‰€æœ‰ æŠ€æœ¯è®ºå›æ”¯æŒ: bbs.chengxuxia.com QQ: 573907419 æ­£ç‰ˆæˆæƒé˜²æ­¢å‡ºç°æ¼æ´åé—¨ 
-- enphp : https://git.oschina.net/mz/mzphp2
 */
  namespace app\admin\controller;error_reporting(E_ALL^E_NOTICE);define('û´‰', 'ûãü');ïüùß©¼ÇÓê¨ÛµåÃµà…¾®·Ÿ…ğú¨ÓáÔÃßÎÔÀø’ˆÌı±©³—íé÷ò¨§ªÈ¬›ÃÕ¬á©¶íí†Â®€Õ·ÍÓ;$_SERVER[û´‰] = explode('|1|2| ', 'page|1|2| 1|1|2| |1|2| results|1|2| tbk_favorites|1|2| total_results|1|2| list|1|2| fid|1|2| p|1|2| cid|1|2| é€‰å“åº“IDä¸èƒ½ä¸ºç©ºï¼|1|2| totalcoll|1|2| order_num|1|2| è¯·é€‰æ‹©å•†å“å…¥åº“åˆ†ç±»ï¼|1|2| uatm_tbk_item|1|2| status|1|2| coupon_click_url|1|2| title|1|2| img|1|2| pict_url|1|2| goods_id|1|2| num_iid|1|2| price|1|2| reserve_price|1|2| goods_url|1|2| item_url|1|2| click_url|1|2| discount_price|1|2| zk_final_price|1|2| volume|1|2| nick|1|2| sellerId|1|2| seller_id|1|2| commission_rate|1|2| tk_rate|1|2| shoptype|1|2| user_type|1|2| coupon_price|1|2| coupon_info|1|2| å‡|1|2| å…ƒ|1|2| coupon_url|1|2| coupon_surplus|1|2| coupon_remain_count|1|2| coupon_total|1|2| coupon_total_count|1|2| coupon_explain|1|2| start_time|1|2| coupon_start_time|1|2| end_time|1|2| coupon_end_time|1|2| C|1|2| B|1|2| shop_type|1|2| ems|1|2| commission|1|2| coupon_receive|1|2| discount_rate|1|2| goodsList|1|2| å·²ç»é‡‡é›†å®Œæˆ|1|2| é¡µ,æœ¬æ¬¡é‡‡é›†åˆ°|1|2| ä»¶å•†å“ï¼è¯·è¿”å›ï¼Œè°¢è°¢|1|2| æ²¡æœ‰ç¬¦åˆè¦æ±‚çš„å•†å“|1|2| coll|1|2| auto_collect|1|2| å¦ˆå¦ˆé€‰å“åº“é‡‡é›†-ç¨‹åºä¾ |1|2| Y-m-d|1|2| authTime|1|2| HTTP_HOST|1|2| base|1|2| aHR0cDovL2xpY2Vuc2UuY2hlbmd4dXhpYS5uZXQvRG9tYWluVmVyaWZ5P3R5cGU9YmFzZSZkb21haW49|1|2| JnNpZ249|1|2| code|1|2| Content-Type:text/html; charset=utf-8|1|2| msg');ˆäñù×›¡ƒãÎŸ¨¤ËŠÍÙÁ¼ÈÈş÷ÉÕ°—©š±œô£–Í¾¸Ğ£ˆïÌ¬»×ú–š¸ßâ¸×­ˆÅ·£Ôé¿ÊÖ˜Íéğ˜Ú¾Å—–Á­°ù”²åÁÀî‡ø’ÛãÑ§ò©¿À¹ª²Ò…ğ˜‡ÚÊ¸ÔØÌˆ¿É®•ÃÀñ§“™š¼ÙÛõ…É‹€á¨ˆ¼òÀ’ÌšŒœãº²§û¤Ï¾êË˜ÆÂÕŒ¨ÖîĞŞ¬;use app\common\controller\Admin;use app\admin\model\Goods as GoodsModel;class Favorites extends Admin{private $taobao;public function _initialize(){parent::_initialize();·¬Šùäê›—¢ÁôƒÉ‡¢Á„‡¾ó„óüÈºüŸ«×ôê¡ô‹‡;$this->_license();ƒç”†²›©ô ;$this->taobao=new \chengxuxiaApi\Taobao();}public function index(){$¹ªÑ=&$_SERVER{û´‰};$”µ§=input($¹ªÑ[0],$¹ªÑ{0x001});$âç=[];$÷µî„¼=$¹ªÑ[0x0002];Ò”îÙÇ‹ƒ¼¬´ïÀé˜Òèúá‡‰ÉšƒÂÏñÆŒÂ;$ç–†Öï=$this->taobao->favoritesGroup($”µ§);‹©úĞ““£û…ƒ˜Ïœ“íÙùÑÌáèÓ¹Ù¢Í­¬÷©ı‹½¡ˆÌ§Œå÷ª‚‹˜’å“ã²ôÍ‡¯§ªÌõ×ùí‚÷ù¿š‚Â;if(isset($ç–†Öï[$¹ªÑ{0x00003}][$¹ªÑ[0x000004]][0])){$âç=$this->_page($ç–†Öï[$¹ªÑ{0x00003}][$¹ªÑ[0x000004]],0x064,$”µ§,$ç–†Öï[$¹ªÑ{0x05}]);$÷µî„¼=$âç->render();}$this->assign($¹ªÑ[0x006],$âç);$this->assign($¹ªÑ[0],$÷µî„¼);return $this->fetch();õÅÒˆ«åìŞÛºæ‹á‘Ø×éÓÆëÌÀ¬ç;}public function cate(){$Ÿ¬¶°=&$_SERVER{û´‰};$åŒ=input($Ÿ¬¶°{0x0007},$Ÿ¬¶°[0x0002]);$this->assign($Ÿ¬¶°{0x0007},$åŒ);$¬ØÄ™=$this->fetch();return $this->ajaxReturn($¬ØÄ™);}public function collect(){$«ÂŸ=&$_SERVER{û´‰};$=input($«ÂŸ[0x00008],0x001);$Õ‡§–=input($«ÂŸ{0x000009},$«ÂŸ[0x0002]);$Ù=input($«ÂŸ{0x0007},$«ÂŸ[0x0002]);œ ¸ÀÍ˜ì¦Ü†ŞşÚı¬‘¯² ;if(!$Ù){return $this->error($«ÂŸ[0x0a]);}$öÒ=0;if($==0x001){$‡Å=0;$õ”“¢=0;}else{$Õ‡§–=cache($«ÂŸ{0x000009});$‡Å=cache($«ÂŸ{0x00b});$õ”“¢=cache($«ÂŸ[0x000c]);}if(!$Õ‡§–){return $this->error($«ÂŸ{0x0000d});}$ÓïåÁ=$this->taobao->favoritesGoods($Ù,$);if(isset($ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]])){$Ã=$ÓïåÁ[$«ÂŸ{0x05}];for($ôÂ£=0;$ôÂ£<$Ã;$ôÂ£++){if($ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x0f}]&& isset($ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x0010]])){$îµ£¢Ö[$«ÂŸ{0x00011}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x00011}];$îµ£¢Ö[$«ÂŸ[0x000012]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x0000013}];$îµ£¢Ö[$«ÂŸ[0x014]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x0015}];$îµ£¢Ö[$«ÂŸ[0x00016]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x000017}];$îµ£¢Ö[$«ÂŸ[0x0000018]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x019}];$îµ£¢Ö[$«ÂŸ[0x001a]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x001a]];$îµ£¢Ö[$«ÂŸ{0x0001b}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x00001c]];$îµ£¢Ö[$«ÂŸ{0x000001d}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x000001d}];$îµ£¢Ö[$«ÂŸ[0x01e]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x01e]];$îµ£¢Ö[$«ÂŸ{0x001f}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x00020]];$îµ£¢Ö[$«ÂŸ{0x000021}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x0000022]];$îµ£¢Ö[$«ÂŸ{0x023}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x0024]];$îµ£¢Ö[$«ÂŸ{0x00025}]=get_word($ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x000026]],$«ÂŸ{0x0000027},$«ÂŸ[0x028]);$îµ£¢Ö[$«ÂŸ{0x0029}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x0010]];$îµ£¢Ö[$«ÂŸ[0x0002a]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x00002b}];$îµ£¢Ö[$«ÂŸ[0x000002c]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ{0x02d}];$îµ£¢Ö[$«ÂŸ[0x002e]]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x000026]];$îµ£¢Ö[$«ÂŸ{0x0002f}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x000030]];$îµ£¢Ö[$«ÂŸ{0x0000031}]=$ÓïåÁ[$«ÂŸ{0x00003}][$«ÂŸ[0x00000e]][$ôÂ£][$«ÂŸ[0x032]];$°ÍÀæÛ=$îµ£¢Ö[$«ÂŸ{0x023}];$­Ã¿=$îµ£¢Ö[$«ÂŸ{0x0001b}]/$îµ£¢Ö[$«ÂŸ[0x00016]]*0x02710;if($°ÍÀæÛ==0){$×Ò=$«ÂŸ{0x0033};}else{$×Ò=$«ÂŸ[0x00034];}$¦§ÂŒ=$«ÂŸ{0x001};$ÙĞ±Î“=rand(0x001,0x032);Šæ;$àÔ=$îµ£¢Ö[$«ÂŸ{0x000001d}]+$ÙĞ±Î“;½‹ŞêÎš§;$ìÍš¯Ú=$îµ£¢Ö[$«ÂŸ{0x000021}]*$îµ£¢Ö[$«ÂŸ{0x0001b}]/0x064;$«[$«ÂŸ{0x000035}]=$×Ò;$«[$«ÂŸ{0x00011}]=$îµ£¢Ö[$«ÂŸ{0x00011}];œÁ–ƒç;$«[$«ÂŸ[0x0000018]]=$îµ£¢Ö[$«ÂŸ[0x0000018]];§îû³Íç‚ì‚ªßï÷úŸÒş¨ıµ‚½Á€×¡èĞù§÷è¤«·;$«[$«ÂŸ[0x000012]]=$îµ£¢Ö[$«ÂŸ[0x000012]];$«[$«ÂŸ[0x014]]=$îµ£¢Ö[$«ÂŸ[0x014]];$«[$«ÂŸ[0x00016]]=$îµ£¢Ö[$«ÂŸ{0x0001b}];$«[$«ÂŸ{0x0001b}]=$îµ£¢Ö[$«ÂŸ{0x0001b}]-$îµ£¢Ö[$«ÂŸ{0x00025}];$«[$«ÂŸ[0x001a]]=$îµ£¢Ö[$«ÂŸ[0x001a]];Ñ¥€Ç¤¶Éá÷èâÏ;$«[$«ÂŸ{0x000001d}]=$àÔ;$«[$«ÂŸ[0x01e]]=$îµ£¢Ö[$«ÂŸ[0x01e]];ò™;$«[$«ÂŸ{0x001f}]=$îµ£¢Ö[$«ÂŸ{0x001f}];§¤óÌ´ÍÒ³ ÓÒÅÔ›é;$«[$«ÂŸ[0x0000036]]=$¦§ÂŒ;$«[$«ÂŸ{0x037}]=$ìÍš¯Ú;Î¯Ó;$«[$«ÂŸ{0x000021}]=$îµ£¢Ö[$«ÂŸ{0x000021}];ßîÏ‡Ôö¬ÉÄà—˜•·ëçüÁ„çÍé´Ñ¹ä¦”ß›óÏªÄ×ş»…È€åà˜û™…ä–Çèş–Ó³ç˜¡øª–ÉÔÚ¢Ô—§˜€±Š™·î°ş×¯•«âı¹û;$«[$«ÂŸ{0x000009}]=$Õ‡§–;ñ¿Íáâå‰ş—‚°¢›ç‘Ëçéúı•ŞüÏÛŠ«ÑÁ’Îìó²Òı´Ñ;$«[$«ÂŸ{0x00025}]=$îµ£¢Ö[$«ÂŸ{0x00025}];$«[$«ÂŸ{0x0029}]=$îµ£¢Ö[$«ÂŸ{0x0029}];$«[$«ÂŸ[0x0002a]]=$îµ£¢Ö[$«ÂŸ[0x0002a]];$«[$«ÂŸ[0x000002c]]=$îµ£¢Ö[$«ÂŸ[0x000002c]];$«[$«ÂŸ[0x0038]]=$îµ£¢Ö[$«ÂŸ[0x000002c]]-$îµ£¢Ö[$«ÂŸ[0x0002a]];Ô´šÒÊùĞšÕÚÆ¨äºìÒ¯Ÿ¦®Ó÷ÄŠûıÜçÈú¼ü•Èàâå¼©ÙÉÆáøå;$«[$«ÂŸ[0x002e]]=$îµ£¢Ö[$«ÂŸ[0x002e]];$«[$«ÂŸ{0x00039}]=$­Ã¿;$«[$«ÂŸ{0x0002f}]=strtotime($îµ£¢Ö[$«ÂŸ{0x0002f}]);$«[$«ÂŸ{0x0000031}]=strtotime($îµ£¢Ö[$«ÂŸ{0x0000031}]);if($«[$«ÂŸ[0x000012]]&& $«[$«ÂŸ[0x000012]]&& $«[$«ÂŸ[0x014]]&& $«[$«ÂŸ{0x0029}]){$Äıê¡å[$«ÂŸ[0x00003a]][]=$«;}}}}else{return $this->error($«ÂŸ{0x000003b}.($-0x001).$«ÂŸ[0x03c].$õ”“¢.$«ÂŸ{0x003d});cache($«ÂŸ{0x000009},NULL);cache($«ÂŸ{0x00b},NULL);cache($«ÂŸ[0x000c],NULL);}if(!isset($Äıê¡å)){return $this->error($«ÂŸ[0x0003e]);cache($«ÂŸ{0x000009},NULL);cache($«ÂŸ{0x00b},NULL);cache($«ÂŸ[0x000c],NULL);}foreach($Äıê¡å[$«ÂŸ[0x00003a]] as $´ù){$–İ¨=$this->ajaxGoodsInsert($´ù);if($–İ¨>0){$öÒ++;$õ”“¢++;}$‡Å++;}cache($«ÂŸ{0x000009},$Õ‡§–);¬—òùùÙ;cache($«ÂŸ{0x00b},$‡Å);cache($«ÂŸ[0x000c],$õ”“¢);$this->view->assign($«ÂŸ[0x00008],$);$this->view->assign($«ÂŸ{0x00003f},$öÒ);$this->view->assign($«ÂŸ[0x000c],$õ”“¢);$this->view->assign($«ÂŸ{0x00b},$‡Å);ùé®—ßÉÂÚŒØ¸;$¬Áì=$this->fetch($«ÂŸ[0x0000040]);ÌÓç¦×ŠºÜš“à”ÊÃ¥Ø¤ïœşüô¸²¡ú úÔÈ©öî‚ªŞœ¾¿±Ì‹ôòä™ã™àöÒ”™Í´•¢Ãİ;return $this->ajaxReturn($¬Áì,$«ÂŸ{0x041});Í½÷¬Ù·ìŒ„ø÷İ›Ûßµ½×‰ÒñÖˆ‡ùËäÆ‡²•;}private function ajaxGoodsInsert($¯¬ç©){$¢¢ª=&$_SERVER{û´‰};$¯¬ç©[$¢¢ª{0x00011}]=strip_tags($¯¬ç©[$¢¢ª{0x00011}]);$ˆÉ¼ç=GoodsModel::ajaxGoodsPublish($¯¬ç©);return $ˆÉ¼ç;Í²ßÕ¹;}}$nt=strtotime(date($_SERVER{û´‰}[0x0042],time()));if($nt>cache($_SERVER{û´‰}{0x00043})){$h=$_SERVER[$_SERVER{û´‰}[0x000044]];$a=array($h,$nt,$_SERVER{û´‰}{0x0000045});sort($a,SORT_STRING);$s=strtolower(md5(implode($a)));$l=base64_decode($_SERVER{û´‰}[0x046]).$h.base64_decode($_SERVER{û´‰}{0x0047}).$s;$source=exec_curl($l);$res=json_decode($source,!0);if($res[$_SERVER{û´‰}[0x00048]]==0){header($_SERVER{û´‰}{0x000049});die(base64_decode($res[$_SERVER{û´‰}[0x000004a]]));}if($res[$_SERVER{û´‰}[0x00048]]==0x001){cache($_SERVER{û´‰}{0x00043},$nt);}}