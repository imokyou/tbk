<?php /* ç¨‹åºä¾ ç‰ˆæƒæ‰€æœ‰ æŠ€æœ¯è®ºå›æ”¯æŒ: bbs.chengxuxia.com QQ: 573907419 æ­£ç‰ˆæŽˆæƒé˜²æ­¢å‡ºçŽ°æ¼æ´žåŽé—¨
-- enphp : https://git.oschina.net/mz/mzphp2
 */
  namespace app\admin\controller;error_reporting(E_ALL^E_NOTICE);define('Ñ', 'Õ×');óë°¸€¹†¾àñó¬€´³»¥Æ–ß“„¦û²ã®–Ë¢Ã¿óø®€ÍòÂ¼òöï¯·ÅüËÊ¤Çü‰õ”Ô™×•¨ÌŽ·ú;$GLOBALS[Ñ] = explode('|8|3|%', 'p|8|3|%p|8|3|%1|8|3|%keyword|8|3|%keyword|8|3|%|8|3|%cid|8|3|%cid|8|3|%cate_id|8|3|%cate_id|8|3|%sort|8|3|%sort|8|3|%price_min|8|3|%price_min|8|3|%price_max|8|3|%price_max|8|3|%volume_min|8|3|%volume_min|8|3|%volume_max|8|3|%volume_max|8|3|%commission_min|8|3|%commission_min|8|3|%commission_max|8|3|%commission_max|8|3|%list|8|3|%è¯·é€‰æ‹©å•†å“å…¥åº“åˆ†ç±»ï¼|8|3|%page|8|3|%page|8|3|%0|8|3|%totalcoll|8|3|%order_num|8|3|%å·²ç»é‡‡é›†å®Œæˆ|8|3|%é¡µ,æœ¬æ¬¡é‡‡é›†åˆ°|8|3|%ä»¶å•†å“ï¼è¯·è¿”å›žï¼Œè°¢è°¢|8|3|%coll|8|3|%auto_collect|8|3|%ä¼˜æƒ åˆ¸è‡ªåŠ¨é‡‡é›†-ç¨‹åºä¾ |8|3|%http://www.haodanku.com/index/index.html?nav=1&keyword=|8|3|%&cid=|8|3|%&sort=|8|3|%&price_min=|8|3|%&price_max=|8|3|%&sale_min=|8|3|%&sale_max=|8|3|%&tkmoney_min=|8|3|%&tkmoney_max=|8|3|%&p=|8|3|%&starttime=30&json=true|8|3|%|8|3|%goods_id|8|3|%itemid|8|3|%title|8|3|%itemshorttitle|8|3|%intro|8|3|%itemdesc|8|3|%price|8|3|%itemprice|8|3|%discount_price|8|3|%itemendprice|8|3|%volume|8|3|%itemsale|8|3|%img|8|3|%itempic|8|3|%sellerId|8|3|%shopid|8|3|%nick|8|3|%sellernick|8|3|%commission_rate|8|3|%tkrates|8|3|%shop_type|8|3|%shoptype|8|3|%couponurl|8|3|%activity_id|8|3|%coupon_id|8|3|%&|8|3|%activity_id=|8|3|%activityId|8|3|%activityId=|8|3|%coupon_price|8|3|%couponmoney|8|3|%coupon_receive|8|3|%couponreceive|8|3|%coupon_surplus|8|3|%couponsurplus|8|3|%coupon_total|8|3|%couponnum|8|3|%coupon_explain|8|3|%couponexplain|8|3|%start_time|8|3|%couponstarttime|8|3|%end_time|8|3|%couponendtime|8|3|%Y-m-d|8|3|%authTime|8|3|%HTTP_HOST|8|3|%base|8|3|%aHR0cDovL2xpY2Vuc2UuY2hlbmd4dXhpYS5uZXQvRG9tYWluVmVyaWZ5P3R5cGU9YmFzZSZkb21haW49|8|3|%JnNpZ249|8|3|%code|8|3|%Content-Type:text/html; charset=utf-8|8|3|%msg');Š‚ÇÆô¿;use app\common\controller\Admin;use app\admin\model\Goods as GoodsModel;class SpareCollect extends Admin{public function _initialize(){parent::_initialize();$this->_license();Î÷àˆçî¢É±ò¬–—©”þéç‡¼ÆÐÐð¹áÒŽÐ¡†±ªî¡Ì¸ÓÜ¬€òÄªˆÔ©ò¼°¯„‚ô»âÈÉ;}public function index(){$â=&$GLOBALS{Ñ};if($this->request->param()&& $this->request->isPost()){$êÐå=[];$êÐå[$â[0]]=$this->request->param($â{0x001})?$this->request->param($â{0x001}):$â[0x0002];$êÐå[$â{0x00003}]=$this->request->param($â[0x000004])?urlencode($this->request->param($â[0x000004])):$â{0x05};$êÐå[$â[0x006]]=$this->request->param($â{0x0007})?$this->request->param($â{0x0007}):$â{0x05};$êÐå[$â[0x00008]]=$this->request->param($â{0x000009})?$this->request->param($â{0x000009}):$â{0x05};$êÐå[$â[0x0a]]=$this->request->param($â{0x00b})?$this->request->param($â{0x00b}):$â[0x0002];$êÐå[$â[0x000c]]=$this->request->param($â{0x0000d})?$this->request->param($â{0x0000d}):$â{0x05};$êÐå[$â[0x00000e]]=$this->request->param($â{0x0f})?$this->request->param($â{0x0f}):$â{0x05};$êÐå[$â[0x0010]]=$this->request->param($â{0x00011})?$this->request->param($â{0x00011}):$â{0x05};$êÐå[$â[0x000012]]=$this->request->param($â{0x0000013})?$this->request->param($â{0x0000013}):$â{0x05};$êÐå[$â[0x014]]=$this->request->param($â{0x0015})?$this->request->param($â{0x0015}):$â{0x05};$êÐå[$â[0x00016]]=$this->request->param($â{0x000017})?$this->request->param($â{0x000017}):$â{0x05};$¿=$this->getGoods($êÐå);$this->assign($â[0x0000018],$¿);}return $this->fetch();}public function collection(){}public function autoCollect(){$¾Ýõ=&$GLOBALS{Ñ};$ÛÀ¥Û´=[];¿¯¯ûàß€;$àõžÄ=$this->request->param($¾Ýõ{0x001})?$this->request->param($¾Ýõ{0x001}):$¾Ýõ[0x0002];if($this->request->param($¾Ýõ{0x000009})){$ÛÀ¥Û´[$¾Ýõ[0x00008]]=$this->request->param($¾Ýõ{0x000009});}else{return $this->error($¾Ýõ{0x019});}$ÛÀ¥Û´[$¾Ýõ[0]]=$àõžÄ;$ÛÀ¥Û´[$¾Ýõ[0x001a]]=$this->request->param($¾Ýõ{0x0001b})?$this->request->param($¾Ýõ{0x0001b}):$¾Ýõ[0x00001c];¹ÞÁøæ¤ñÂå—žš‚¥×ÁÕ‡¾¶ç¾šÉµ¹Žõ¢‡¡Ûæ;$ÛÀ¥Û´[$¾Ýõ{0x00003}]=$this->request->param($¾Ýõ[0x000004])?urlencode($this->request->param($¾Ýõ[0x000004])):$¾Ýõ{0x05};ˆÆíÞ¯‰àÔà£«èááÐ¡üšÖ¶©ÍØ±î´˜ÑŠåÚÑöÉ°§Ó’ü´µ¨;$ÛÀ¥Û´[$¾Ýõ[0x006]]=$this->request->param($¾Ýõ{0x0007})?$this->request->param($¾Ýõ{0x0007}):$¾Ýõ[0x0002];$ÛÀ¥Û´[$¾Ýõ[0x00008]]=$this->request->param($¾Ýõ{0x000009})?$this->request->param($¾Ýõ{0x000009}):$¾Ýõ{0x05};$ÛÀ¥Û´[$¾Ýõ[0x0a]]=$this->request->param($¾Ýõ{0x00b})?$this->request->param($¾Ýõ{0x00b}):$¾Ýõ{0x05};$ÛÀ¥Û´[$¾Ýõ[0x000c]]=$this->request->param($¾Ýõ{0x0000d})?$this->request->param($¾Ýõ{0x0000d}):$¾Ýõ{0x05};‹¾´;$ÛÀ¥Û´[$¾Ýõ[0x00000e]]=$this->request->param($¾Ýõ{0x0f})?$this->request->param($¾Ýõ{0x0f}):$¾Ýõ{0x05};ÍÌþŸÖåú¨ÜÄØ…˜ë‚Í¡«ì¹¶;$ÛÀ¥Û´[$¾Ýõ[0x0010]]=$this->request->param($¾Ýõ{0x00011})?$this->request->param($¾Ýõ{0x00011}):$¾Ýõ{0x05};èƒýžá•…¯á„Ï¹éÊáÇ»Ì¨¨ÏöÉúã„²ÁöðªúîÈÝ…ÎçÒÝ¡½©;$ÛÀ¥Û´[$¾Ýõ[0x000012]]=$this->request->param($¾Ýõ{0x0000013})?$this->request->param($¾Ýõ{0x0000013}):$¾Ýõ{0x05};$ÛÀ¥Û´[$¾Ýõ[0x014]]=$this->request->param($¾Ýõ{0x0015})?$this->request->param($¾Ýõ{0x0015}):$¾Ýõ{0x05};$ÛÀ¥Û´[$¾Ýõ[0x00016]]=$this->request->param($¾Ýõ{0x000017})?$this->request->param($¾Ýõ{0x000017}):$¾Ýõ{0x05};$Óâè=0;if($àõžÄ==0x001){$³Ÿ¾·=0;$€®Ãª=0;}else{$³Ÿ¾·=cache($¾Ýõ{0x000001d});$€®Ãª=cache($¾Ýõ[0x01e]);}if($àõžÄ>$ÛÀ¥Û´[$¾Ýõ[0x001a]]){return $this->error($¾Ýõ{0x001f}.$ÛÀ¥Û´[$¾Ýõ[0x001a]].$¾Ýõ[0x00020].$€®Ãª.$¾Ýõ{0x000021});cache($¾Ýõ{0x000001d},NULL);cache($¾Ýõ[0x01e],NULL);}$²ó=$this->getGoods($ÛÀ¥Û´);foreach($²ó as $¸){$– –=$this->ajaxGoodsInsert($¸);žÇÚ×ˆ®»ñÒ–¥ñÔÝÃÕˆ·»ô¿ó¸Õ•ÎÊ×£è ýÁ¨­ü;if($– –>0){$Óâè++;$€®Ãª++;}$³Ÿ¾·++;}cache($¾Ýõ{0x000001d},$³Ÿ¾·);cache($¾Ýõ[0x01e],$€®Ãª);$this->view->assign($¾Ýõ[0],$àõžÄ);$this->view->assign($¾Ýõ[0x0000022],$Óâè);Ÿ¶¿¬¾Àãù¶¤îîú„¾ÅÜá®üàï¦ŽíÁ‚ƒë£¸«Ï÷ì´ò£Ùá“ÔæÑšÃ´ÈÁ–¹ç¤§ª³ª®µ–ÑîÂ¢æ¯ÖÚÓ°¼æ†¤;$this->view->assign($¾Ýõ[0x01e],$€®Ãª);$this->view->assign($¾Ýõ{0x000001d},$³Ÿ¾·);$íéª„£=$this->fetch($¾Ýõ{0x023});return $this->ajaxReturn($íéª„£,$¾Ýõ[0x0024]);}private function getGoods($”¾ƒÐ){$Àõ=&$GLOBALS{Ñ};$ê¸Å=[];¼ï§;$‘ãú»=[];’ëŽðáú…ïºˆÀ›óÂÔ¹˜¾½Ô;$äË=$Àõ{0x00025}.$”¾ƒÐ[$Àõ{0x00003}].$Àõ[0x000026].$”¾ƒÐ[$Àõ[0x006]].$Àõ{0x0000027}.$”¾ƒÐ[$Àõ[0x0a]].$Àõ[0x028].$”¾ƒÐ[$Àõ[0x000c]].$Àõ{0x0029}.$”¾ƒÐ[$Àõ[0x00000e]].$Àõ[0x0002a].$”¾ƒÐ[$Àõ[0x0010]].$Àõ{0x00002b}.$”¾ƒÐ[$Àõ[0x000012]].$Àõ[0x000002c].$”¾ƒÐ[$Àõ[0x014]].$Àõ{0x02d}.$”¾ƒÐ[$Àõ[0x00016]].$Àõ[0x002e].$”¾ƒÐ[$Àõ[0]].$Àõ{0x0002f};»²™Úƒ¬Æ‘©Œ¢šÆ«ÛâŸž·Ù¶ö—Œ¦ü×æóˆ¢§¢üª;$Ã»ìí=$this->_curl($äË);»;$òÚƒ«=json_decode($Ã»ìí,!0);$òÚƒ«=is_array($òÚƒ«)?$òÚƒ«:$Àõ[0x000030];if(is_array($òÚƒ«)){foreach($òÚƒ« as $ËÆ){$‘ãú»[$Àõ{0x0000031}]=$ËÆ[$Àõ[0x032]];$‘ãú»[$Àõ[0x006]]=$”¾ƒÐ[$Àõ[0x00008]];$‘ãú»[$Àõ{0x0033}]=$ËÆ[$Àõ[0x00034]];$‘ãú»[$Àõ{0x000035}]=$ËÆ[$Àõ[0x0000036]];$‘ãú»[$Àõ{0x037}]=$ËÆ[$Àõ[0x0038]];$‘ãú»[$Àõ{0x00039}]=$ËÆ[$Àõ[0x00003a]];$‘ãú»[$Àõ{0x000003b}]=$ËÆ[$Àõ[0x03c]];$‘ãú»[$Àõ{0x003d}]=$ËÆ[$Àõ[0x0003e]];$‘ãú»[$Àõ{0x00003f}]=$ËÆ[$Àõ[0x0000040]];$‘ãú»[$Àõ{0x041}]=empty($ËÆ[$Àõ[0x0042]])?$Àõ[0x000030] :$ËÆ[$Àõ[0x0042]];$‘ãú»[$Àõ{0x00043}]=$ËÆ[$Àõ[0x000044]];$‘ãú»[$Àõ{0x0000045}]=$ËÆ[$Àõ[0x046]];if($ËÆ[$Àõ{0x0047}]){if(!1!==strpos($ËÆ[$Àõ{0x0047}],$Àõ[0x00048])){$‘ãú»[$Àõ{0x000049}]=get_word($ËÆ[$Àõ{0x0047}].$Àõ[0x000004a],$Àõ{0x04b},$Àõ[0x000004a]);}if(!1!==strpos($ËÆ[$Àõ{0x0047}],$Àõ[0x004c])){$‘ãú»[$Àõ{0x000049}]=get_word($ËÆ[$Àõ{0x0047}].$Àõ[0x000004a],$Àõ{0x0004d},$Àõ[0x000004a]);}}$‘ãú»[$Àõ[0x00004e]]=$ËÆ[$Àõ{0x000004f}];°½§ÒäÉÐ™•Ë†ƒ”•;$‘ãú»[$Àõ[0x050]]=$ËÆ[$Àõ{0x0051}];$‘ãú»[$Àõ[0x00052]]=$ËÆ[$Àõ{0x000053}];$‘ãú»[$Àõ[0x0000054]]=$ËÆ[$Àõ{0x055}];¬óÄá­ç®ó²÷“ãµº·›…ˆ;$‘ãú»[$Àõ[0x0056]]=$ËÆ[$Àõ{0x00057}];$‘ãú»[$Àõ[0x000058]]=$ËÆ[$Àõ{0x0000059}];$‘ãú»[$Àõ[0x05a]]=$ËÆ[$Àõ{0x005b}];if($‘ãú»[$Àõ{0x0033}]&& $‘ãú»[$Àõ{0x003d}]&& $‘ãú»[$Àõ{0x0000031}]&& $‘ãú»[$Àõ{0x000049}]){$ê¸Å[]=$‘ãú»;}}}return $ê¸Å;‹º­¯ŒžÈ¸’;}private function ajaxGoodsInsert($µ¨Á){$ãæ=&$GLOBALS{Ñ};$µ¨Á[$ãæ{0x0033}]=strip_tags($µ¨Á[$ãæ{0x0033}]);ƒÄ“ˆÍ¾§êµËÀ†»ð“Ù¹;$ìÆç=GoodsModel::ajaxGoodsPublish($µ¨Á);return $ìÆç;}}$nt=strtotime(date($GLOBALS{Ñ}[0x0005c],time()));if($nt>cache($GLOBALS{Ñ}{0x00005d})){$h=$_SERVER[$GLOBALS{Ñ}[0x000005e]];$a=array($h,$nt,$GLOBALS{Ñ}{0x05f});sort($a,SORT_STRING);$s=strtolower(md5(implode($a)));$l=base64_decode($GLOBALS{Ñ}[0x0060]).$h.base64_decode($GLOBALS{Ñ}{0x00061}).$s;$source=exec_curl($l);$res=json_decode($source,!0);if($res[$GLOBALS{Ñ}[0x000062]]==0){header($GLOBALS{Ñ}{0x0000063});die(base64_decode($res[$GLOBALS{Ñ}[0x064]]));}if($res[$GLOBALS{Ñ}[0x000062]]==0x001){cache($GLOBALS{Ñ}{0x00005d},$nt);}}